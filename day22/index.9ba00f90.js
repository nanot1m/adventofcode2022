var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},n=e.parcelRequiree764;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var r={id:e,exports:{}};return t[e]=r,n.call(r.exports,r,r.exports),r.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){o[e]=t},e.parcelRequiree764=n);var r=n("7zFg5"),s=n("idVGl"),i=n("c04jy"),c=n("1CMLe"),a=n("jOfNW"),l=n("hyM6K");const f=e=>{const[t,o]=(0,c.readBlocks)(e),n=(0,c.readLines)(t);let r=1/0;for(const e of n){const t=e.trim(),o=e.length-t.length;0!==o&&(r=Math.min(r,o))}const l=new(0,a.Map2d);for(let e=0;e<n.length;e++)for(let t=0;t<n[e].length;t++)" "!==n[e][t]&&l.set(s.V.vec(t,e),n[e][t]);const f=(0,i.it)(l).filter((e=>"."===e.value)).toArray().sort(((e,t)=>e.pos[1]-t.pos[1]||e.pos[0]-t.pos[0]))[0].pos,d=[];let u="";for(let e of o)"L"===e||"R"===e?(u&&d.push(u,e),u=""):u+=e;return d.push(u),{map:l,start:f,moves:d,sideSize:r}};const d=[(0,l.asDir)("D"),(0,l.asDir)("R"),(0,l.asDir)("U"),(0,l.asDir)("L")];(0,l.asDir)("R"),(0,l.asDir)("D"),(0,l.asDir)("L"),(0,l.asDir)("U");function*u(e,t,o,n,r=!1){let i=n,c=1;const f=new(0,a.Map2d);function u(t,n){let i=s.V.add(t,l.DIR_TO_VEC[n]);const c=e.get(i);if("."===c)return t=i,f.set(t,n),{pos:t,ok:!0,dir:n};if("#"===c)return{pos:t,ok:!1,dir:n};const a=o.get(t);if(null==a)throw new Error("no connection at pos "+t.join(",")+" dir "+n);if(null==a[n])throw new Error("Connection at pos "+t.join(",")+" dir "+n+" is null");return"#"===e.get(a[n])?{pos:t,ok:!1,dir:n}:(i=a[n],r&&("L"===n&&50===s.V.x(t)&&s.V.y(t)<50?n="R":"L"===n&&50===s.V.x(t)?n="U":"L"===n&&0===s.V.x(t)&&s.V.y(t)<150?n="R":"L"===n&&0===s.V.x(t)?n="U":"U"===n&&149===s.V.y(t)||"U"===n&&49===s.V.y(t)?n="L":"U"===n&&199===s.V.y(t)?n="U":"D"===n&&0===s.V.y(t)&&s.V.x(t)<100?n="R":"D"===n&&0===s.V.y(t)?n="D":"D"===n&&100===s.V.y(t)?n="R":"R"===n&&149===s.V.x(t)?n="L":"R"===n&&99===s.V.x(t)&&s.V.y(t)<100?n="D":"R"===n&&99===s.V.x(t)?n="L":"R"===n&&49===s.V.x(t)&&(n="D")),f.set(t,n),{pos:i,ok:!0,dir:n})}function v(e,t,o,n){const r=u(n,{U:"D",D:"U",L:"R",R:"L"}[o]);if(!r.ok)throw new Error("Plane switch failed. Expected to go back to "+n);if(r.pos.join(",")!==t.join(","))throw new Error(`Plane switch from ${e} at ${t.join(",")} to ${o} at ${n.join(",")} failed. Expected to go back to ${t.join(",")} but got ${r.pos.join(",")}`)}for(const e of t){const t=Number(e);if(isNaN(t)){c+="L"===e?-1:1,c=(c+4)%4,yield{pos:i,dir:d[c],visited:f,move:e};continue}let o=d[c];for(let n=0;n<t;n++){const t=u(i,o);if(!t.ok)break;v(o,i,t.dir,t.pos),i=t.pos,o=t.dir,c=d.indexOf(o),yield{pos:i,dir:o,visited:f,move:e}}}}function v(e){const t=new(0,a.Map2d);for(const o of(0,i.range)(e)){const n=s.V.vec(e+o,0),r=t.get(n)??{},i=s.V.vec(0,3*e+o),c=t.get(i)??{};r.D=i,c.L=n,t.set(n,r),t.set(i,c)}for(const o of(0,i.range)(e)){const n=s.V.vec(2*e+o,0),r=t.get(n)??{},i=s.V.vec(o,4*e-1),c=t.get(i)??{};r.D=i,c.U=n,t.set(n,r),t.set(i,c)}for(const o of(0,i.range)(e)){const n=s.V.vec(3*e-1,o),r=t.get(n)??{},i=s.V.vec(2*e-1,3*e-o-1),c=t.get(i)??{};r.R=i,c.R=n,t.set(n,r),t.set(i,c)}for(const o of(0,i.range)(e)){const n=s.V.vec(2*e+o,e-1),r=t.get(n)??{},i=s.V.vec(2*e-1,e+o),c=t.get(i)??{};r.U=i,c.R=n,t.set(n,r),t.set(i,c)}for(const o of(0,i.range)(e)){const n=s.V.vec(e+o,3*e-1),r=s.V.vec(e-1,3*e+o),i=t.get(n)??{},c=t.get(r)??{};i.U=r,c.R=n,t.set(n,i),t.set(r,c)}for(const o of(0,i.range)(e)){const n=s.V.vec(0,2*e+o),r=s.V.vec(e,e-o-1),i=t.get(n)??{},c=t.get(r)??{};i.L=r,c.L=n,t.set(n,i),t.set(r,c)}for(const o of(0,i.range)(e)){const n=s.V.vec(o,2*e),r=s.V.vec(e,e+o),i=t.get(n)??{},c=t.get(r)??{};i.D=r,c.L=n,t.set(n,i),t.set(r,c)}return t}i=n("c04jy");const g=document.getElementById("canvas");if(!(g instanceof HTMLCanvasElement))throw new Error("no canvas");const p=g.getContext("2d");if(!p)throw new Error("no ctx");const m=(0,r.scaleCanvasToPixelRatio)(p,400,400);g.style.width="200px",g.style.height="200px";const h=document.getElementById("input-form");if(!(h instanceof HTMLFormElement))throw new Error("no form");const w=document.getElementById("speed");if(!(w instanceof HTMLInputElement))throw new Error("no speed input");let E=100;w.value=String(1e3/E),w.addEventListener("input",(function(e){E=1e3/Number(this.value)}));const V=document.getElementById("next");h.addEventListener("submit",(function(e){e.preventDefault();!function(e,t){k&&cancelAnimationFrame(k);t.canvas.scrollIntoView({behavior:"smooth"});const{map:o,moves:n,start:r,sideSize:s}=f(e),c=v(s),a=u(o,n,c,r,s);if(!V)throw new Error("no next button");function l(e,o){t.fillStyle="#51cf66",t.fillRect(2*e[0],2*e[1],2,2),R("front",[1,1]),R("top",[1,0]),R("right",[2,0]),R("bottom",[1,2]),R("left",[0,2]),R("back",[0,3]);let n="front";n=e[1]<50?e[0]<100?"top":"right":e[1]<100?"front":e[1]<150?e[0]<50?"left":"bottom":"back";const r=document.querySelector(`[name="rotate-cube-side"][value="${n}"]`);r instanceof HTMLInputElement&&(r.checked=!0,D())}function d(){for(const e of o)t.fillStyle=b[e.value]??"white",t.fillRect(2*e.pos[0],2*e.pos[1],2,2);l(r,"R")}function g(){const e=a.next();if(e.done)return;const{dir:t,pos:o,move:n}=e.value;l(o,t),document.getElementById("status").innerText=`Move: ${n}, Dir: ${M[t]}`}V.onclick=()=>{const e=a.next();if(e.done)return;const{dir:t,pos:o,move:n}=e.value;l(o,t),document.getElementById("status").innerText=`Move: ${n}, Dir: ${M[t]}`},V.removeAttribute("disabled"),t.fillStyle="black",t.fillRect(0,0,t.canvas.width,t.canvas.height),d();let p=0;function m(e){if(0===p)p=e,g();else if(e-p>E){const t=Math.floor((e-p)/E);p=e;for(const e of(0,i.range)(t))g()}k=requestAnimationFrame(m)}m(0)}((new FormData(this).get("input")?.toString()??"").trimEnd(),p)}));const y=document.querySelector(".cube"),L=document.querySelector(".radio-group");let x="";function D(){if(!(L instanceof HTMLElement))throw new Error("no radio group");var e=L.querySelector(":checked");if(e instanceof HTMLInputElement){var t="show-"+e.value;x&&y&&y.classList.remove(x),y?.classList.add(t),x=t}}function R(e,t){const o=document.querySelector(`.cube__face--${e}`);if(!(g instanceof HTMLCanvasElement))throw new Error("no canvas");if(o instanceof HTMLElement){let e,n=o.querySelector("canvas");if(!n){if(n=document.createElement("canvas"),e=n.getContext("2d"),!e)throw new Error("no ctx");e.canvas.width=100*m,e.canvas.height=100*m,o.appendChild(n)}if(e=n.getContext("2d"),!e)throw new Error("no ctx");e.drawImage(g,50*-t[0]*2*m,50*-t[1]*2*m)}}D(),L?.addEventListener("change",D);const b={".":"white","#":"#343a40"},M={D:"↑",U:"↓",L:"←",R:"→"};let k=0;
//# sourceMappingURL=index.9ba00f90.js.map
