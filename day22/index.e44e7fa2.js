var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},n=e.parcelRequiree764;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var r={id:e,exports:{}};return t[e]=r,n.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},e.parcelRequiree764=n);var r=n("7zFg5"),i=n("idVGl"),s=n("c04jy"),c=n("1CMLe"),a=n("jOfNW"),l=n("hyM6K");const f=e=>{const[t,o]=(0,c.readBlocks)(e),n=(0,c.readLines)(t);let r=1/0;for(const e of n){const t=e.trim(),o=e.length-t.length;0!==o&&(r=Math.min(r,o))}const l=new(0,a.Map2d);for(let e=0;e<n.length;e++)for(let t=0;t<n[e].length;t++)" "!==n[e][t]&&l.set(i.V.vec(t,e),n[e][t]);const f=(0,s.it)(l).filter((e=>"."===e.value)).toArray().sort(((e,t)=>e.pos[1]-t.pos[1]||e.pos[0]-t.pos[0]))[0].pos,d=[];let u="";for(let e of o)"L"===e||"R"===e?(u&&d.push(u,e),u=""):u+=e;return d.push(u),{map:l,start:f,moves:d,sideSize:r}};const d=[(0,l.asDir)("D"),(0,l.asDir)("R"),(0,l.asDir)("U"),(0,l.asDir)("L")];(0,l.asDir)("R"),(0,l.asDir)("D"),(0,l.asDir)("L"),(0,l.asDir)("U");function*u(e,t,o,n,r=!1){let s=n,c=1;const f=new(0,a.Map2d);function u(t,n){let s=i.V.add(t,l.DIR_TO_VEC[n]);const c=e.get(s);if("."===c)return t=s,f.set(t,n),{pos:t,ok:!0,dir:n};if("#"===c)return{pos:t,ok:!1,dir:n};const a=o.get(t);if(null==a)throw new Error("no connection at pos "+t.join(",")+" dir "+n);if(null==a[n])throw new Error("Connection at pos "+t.join(",")+" dir "+n+" is null");return"#"===e.get(a[n])?{pos:t,ok:!1,dir:n}:(s=a[n],r&&("L"===n&&50===i.V.x(t)&&i.V.y(t)<50?n="R":"L"===n&&50===i.V.x(t)?n="U":"L"===n&&0===i.V.x(t)&&i.V.y(t)<150?n="R":"L"===n&&0===i.V.x(t)?n="U":"U"===n&&149===i.V.y(t)||"U"===n&&49===i.V.y(t)?n="L":"U"===n&&199===i.V.y(t)?n="U":"D"===n&&0===i.V.y(t)&&i.V.x(t)<100?n="R":"D"===n&&0===i.V.y(t)?n="D":"D"===n&&100===i.V.y(t)?n="R":"R"===n&&149===i.V.x(t)?n="L":"R"===n&&99===i.V.x(t)&&i.V.y(t)<100?n="D":"R"===n&&99===i.V.x(t)?n="L":"R"===n&&49===i.V.x(t)&&(n="D")),f.set(t,n),{pos:s,ok:!0,dir:n})}function v(e,t,o,n){const r=u(n,{U:"D",D:"U",L:"R",R:"L"}[o]);if(!r.ok)throw new Error("Plane switch failed. Expected to go back to "+n);if(r.pos.join(",")!==t.join(","))throw new Error(`Plane switch from ${e} at ${t.join(",")} to ${o} at ${n.join(",")} failed. Expected to go back to ${t.join(",")} but got ${r.pos.join(",")}`)}for(const e of t){const t=Number(e);if(isNaN(t)){c+="L"===e?-1:1,c=(c+4)%4,yield{pos:s,dir:d[c],visited:f,move:e};continue}let o=d[c];for(let n=0;n<t;n++){const t=u(s,o);if(!t.ok)break;v(o,s,t.dir,t.pos),s=t.pos,o=t.dir,c=d.indexOf(o),yield{pos:s,dir:o,visited:f,move:e}}}}function v(e){const t=new(0,a.Map2d);for(const o of(0,s.range)(e)){const n=i.V.vec(e+o,0),r=t.get(n)??{},s=i.V.vec(0,3*e+o),c=t.get(s)??{};r.D=s,c.L=n,t.set(n,r),t.set(s,c)}for(const o of(0,s.range)(e)){const n=i.V.vec(2*e+o,0),r=t.get(n)??{},s=i.V.vec(o,4*e-1),c=t.get(s)??{};r.D=s,c.U=n,t.set(n,r),t.set(s,c)}for(const o of(0,s.range)(e)){const n=i.V.vec(3*e-1,o),r=t.get(n)??{},s=i.V.vec(2*e-1,3*e-o-1),c=t.get(s)??{};r.R=s,c.R=n,t.set(n,r),t.set(s,c)}for(const o of(0,s.range)(e)){const n=i.V.vec(2*e+o,e-1),r=t.get(n)??{},s=i.V.vec(2*e-1,e+o),c=t.get(s)??{};r.U=s,c.R=n,t.set(n,r),t.set(s,c)}for(const o of(0,s.range)(e)){const n=i.V.vec(e+o,3*e-1),r=i.V.vec(e-1,3*e+o),s=t.get(n)??{},c=t.get(r)??{};s.U=r,c.R=n,t.set(n,s),t.set(r,c)}for(const o of(0,s.range)(e)){const n=i.V.vec(0,2*e+o),r=i.V.vec(e,e-o-1),s=t.get(n)??{},c=t.get(r)??{};s.L=r,c.L=n,t.set(n,s),t.set(r,c)}for(const o of(0,s.range)(e)){const n=i.V.vec(o,2*e),r=i.V.vec(e,e+o),s=t.get(n)??{},c=t.get(r)??{};s.D=r,c.L=n,t.set(n,s),t.set(r,c)}return t}s=n("c04jy");const g=document.getElementById("canvas");if(!(g instanceof HTMLCanvasElement))throw new Error("no canvas");const p=g.getContext("2d");if(!p)throw new Error("no ctx");const m=(0,r.scaleCanvasToPixelRatio)(p,400,400);g.style.width="200px",g.style.height="200px";const h=document.getElementById("input-form");if(!(h instanceof HTMLFormElement))throw new Error("no form");const w=document.getElementById("speed");if(!(w instanceof HTMLInputElement))throw new Error("no speed input");let E=100;w.value=String(1e3/E),w.addEventListener("input",(function(e){E=1e3/Number(this.value)}));const V=document.getElementById("next");h.addEventListener("submit",(function(e){e.preventDefault();!function(e,t){k&&cancelAnimationFrame(k);t.canvas.scrollIntoView({behavior:"smooth"});const{map:o,moves:n,start:r,sideSize:i}=f(e),c=v(i),a=u(o,n,c,r,i);if(!V)throw new Error("no next button");function l(e,o,n,r){if(t.fillStyle=n,t.fillRect(2*e[0],2*e[1],2,2),!r){R("front",[1,1]),R("top",[1,0]),R("right",[2,0]),R("bottom",[1,2]),R("left",[0,2]),R("back",[0,3]);let t="front";t=e[1]<50?e[0]<100?"top":"right":e[1]<100?"front":e[1]<150?e[0]<50?"left":"bottom":"back";const o=document.querySelector(`[name="rotate-cube-side"][value="${t}"]`);o instanceof HTMLInputElement&&(o.checked=!0,D())}}function d(){for(const e of o)t.fillStyle=b[e.value]??"white",t.fillRect(2*e.pos[0],2*e.pos[1],2,2);l(r,"R")}let g;function p(){const e=a.next();if(e.done)return;const{dir:t,pos:o,move:n}=e.value;g&&l(g,t,"#51cf66",!0),l(o,t,"#e03131"),g=o,document.getElementById("status").innerText=`Move: ${n}, Dir: ${M[t]}`}V.onclick=()=>{const e=a.next();if(e.done)return;const{dir:t,pos:o,move:n}=e.value;l(o,t),document.getElementById("status").innerText=`Move: ${n}, Dir: ${M[t]}`},V.removeAttribute("disabled"),t.fillStyle="black",t.fillRect(0,0,t.canvas.width,t.canvas.height),d();let m=0;function h(e){if(0===m)m=e,p();else if(e-m>E){const t=Math.floor((e-m)/E);m=e;for(const e of(0,s.range)(t))p()}k=requestAnimationFrame(h)}h(0)}((new FormData(this).get("input")?.toString()??"").trimEnd(),p)}));const y=document.querySelector(".cube"),L=document.querySelector(".radio-group");let x="";function D(){if(!(L instanceof HTMLElement))throw new Error("no radio group");var e=L.querySelector(":checked");if(e instanceof HTMLInputElement){var t="show-"+e.value;x&&y&&y.classList.remove(x),y?.classList.add(t),x=t}}function R(e,t){const o=document.querySelector(`.cube__face--${e}`);if(!(g instanceof HTMLCanvasElement))throw new Error("no canvas");if(o instanceof HTMLElement){let e,n=o.querySelector("canvas");if(!n){if(n=document.createElement("canvas"),e=n.getContext("2d"),!e)throw new Error("no ctx");e.canvas.width=100*m,e.canvas.height=100*m,o.appendChild(n)}if(e=n.getContext("2d"),!e)throw new Error("no ctx");e.drawImage(g,50*-t[0]*2*m,50*-t[1]*2*m)}}D(),L?.addEventListener("change",D);const b={".":"white","#":"#343a40"},M={D:"↑",U:"↓",L:"←",R:"→"};let k=0;
//# sourceMappingURL=index.e44e7fa2.js.map
